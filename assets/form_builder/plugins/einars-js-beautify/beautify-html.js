function style_html(d,h,c,a){var f,b;function f(){this.pos=0;this.token="";this.current_mode="CONTENT";this.tags={parent:"parent1",parentcount:1,parent1:""};this.tag_type="";this.token_text=this.last_token=this.last_text=this.token_type="";this.prev_start_tag="";this.Utils={whitespace:"\n\r\t ".split(""),single_token:"br,input,link,meta,!doctype,basefont,base,area,hr,wbr,param,img,isindex,?xml,embed".split(","),extra_liners:"form,div,head,body,/html".split(","),same_line:["label","textarea"],in_array:function(l,j){for(var k=0;k<j.length;k++){if(l===j[k]){return true}}return false}};this.get_content=function(){var m="";var l=[];var j=false;while(this.input.charAt(this.pos)!=="<"){if(this.pos>=this.input.length){return l.length?l.join(""):["","TK_EOF"]}m=this.input.charAt(this.pos);this.pos++;this.line_char_count++;if(this.Utils.in_array(m,this.Utils.whitespace)){if(l.length){j=true}this.line_char_count--;continue}else{if(j){if(this.line_char_count>=this.max_char){l.push("\n");for(var k=0;k<this.indent_level;k++){l.push(this.indent_string)}this.line_char_count=0}else{l.push(" ");this.line_char_count++}j=false}}l.push(m)}return l.length?l.join(""):""};this.get_script=function(){var m="";var l=[];var j=new RegExp("</script>","igm");j.lastIndex=this.pos;var k=j.exec(this.input);var i=k?k.index:this.input.length;while(this.pos<i){if(this.pos>=this.input.length){return l.length?l.join(""):["","TK_EOF"]}m=this.input.charAt(this.pos);this.pos++;l.push(m)}return l.length?l.join(""):""};this.record_tag=function(i){if(this.tags[i+"count"]){this.tags[i+"count"]++;this.tags[i+this.tags[i+"count"]]=this.indent_level}else{this.tags[i+"count"]=1;this.tags[i+this.tags[i+"count"]]=this.indent_level}this.tags[i+this.tags[i+"count"]+"parent"]=this.tags.parent;this.tags.parent=i+this.tags[i+"count"]};this.retrieve_tag=function(i){if(this.tags[i+"count"]){var j=this.tags.parent;while(j){if(i+this.tags[i+"count"]===j){break}j=this.tags[j+"parent"]}if(j){this.indent_level=this.tags[i+this.tags[i+"count"]];this.tags.parent=this.tags[j+"parent"]}delete this.tags[i+this.tags[i+"count"]+"parent"];delete this.tags[i+this.tags[i+"count"]];if(this.tags[i+"count"]==1){delete this.tags[i+"count"]}else{this.tags[i+"count"]--}}};this.get_tag=function(){var i="";var m=[];var n=false;do{if(this.pos>=this.input.length){return m.length?m.join(""):["","TK_EOF"]}i=this.input.charAt(this.pos);this.pos++;this.line_char_count++;if(this.Utils.in_array(i,this.Utils.whitespace)){n=true;this.line_char_count--;continue}if(i==="'"||i==='"'){if(!m[1]||m[1]!=="!"){i+=this.get_unformatted(i);n=true}}if(i==="="){n=false}if(m.length&&m[m.length-1]!=="="&&i!==">"&&n){if(this.line_char_count>=this.max_char){this.print_newline(false,m);this.line_char_count=0}else{m.push(" ");this.line_char_count++}n=false}m.push(i)}while(i!==">");var o=m.join("");var l;if(o.indexOf(" ")!=-1){l=o.indexOf(" ")}else{l=o.indexOf(">")}var j=o.substring(1,l).toLowerCase();if(o.charAt(o.length-2)==="/"||this.Utils.in_array(j,this.Utils.single_token)){this.tag_type="SINGLE"}else{if(j==="script"){this.record_tag(j);this.tag_type="SCRIPT"}else{if(j==="style"){this.record_tag(j);this.tag_type="STYLE"}else{if(j==="a"){var k=this.get_unformatted("</a>",o);m.push(k);this.tag_type="SINGLE"}else{if(j.charAt(0)==="!"){if(j.indexOf("[if")!=-1){if(o.indexOf("!IE")!=-1){var k=this.get_unformatted("-->",o);m.push(k)}this.tag_type="START"}else{if(j.indexOf("[endif")!=-1){this.tag_type="END";this.unindent()}else{if(j.indexOf("[cdata[")!=-1){var k=this.get_unformatted("]]>",o);m.push(k);this.tag_type="SINGLE"}else{var k=this.get_unformatted("-->",o);m.push(k);this.tag_type="SINGLE"}}}}else{if(j.charAt(0)==="/"){this.retrieve_tag(j.substring(1));this.tag_type="END"}else{this.record_tag(j);this.tag_type="START"}if(this.Utils.in_array(j,this.Utils.extra_liners)){this.print_newline(true,this.output);this.print_newline(true,this.output)}}}}}}return{tag:m.join(""),tag_check:j}};this.get_unformatted=function(m,k){if(k&&k.indexOf(m)!=-1){return""}var j="";var l="";var o=true;do{if(this.pos>=this.input.length){return l}j=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(j,this.Utils.whitespace)){if(!o){this.line_char_count--;continue}if(j==="\n"||j==="\r"){l+="\n";for(var n=0;n<this.indent_level;n++){l+=this.indent_string}o=false;this.line_char_count=0;continue}}l+=j;this.line_char_count++;o=true}while(l.indexOf(m)==-1);return l};this.get_token=function(){var i,k;if(this.last_token==="TK_TAG_SCRIPT"){var l=this.get_script();if(typeof l!=="string"){return l}i=js_beautify(l,{indent_size:this.indent_size,indent_char:this.indent_character,indent_level:this.indent_level});return[i,"TK_CONTENT"]}if(this.current_mode==="CONTENT"){i=this.get_content();if(typeof i!=="string"){return i}else{return[i,"TK_CONTENT"]}}if(this.current_mode==="TAG"){k=this.get_tag();i=k.tag;if(typeof i!=="string"){return i}else{var j="TK_TAG_"+this.tag_type;return[i,j,k.tag_check]}}};this.printer=function(k,j,m,n){this.input=k||"";this.output=[];this.indent_character=j||" ";this.indent_string="";this.indent_size=m||2;this.indent_level=0;this.max_char=n||70;this.line_char_count=0;for(var l=0;l<this.indent_size;l++){this.indent_string+=this.indent_character}this.print_newline=function(p,o){this.line_char_count=0;if(!o||!o.length){return}if(!p){while(this.Utils.in_array(o[o.length-1],this.Utils.whitespace)){o.pop()}}o.push("\n");for(var q=0;q<this.indent_level;q++){o.push(this.indent_string)}};this.print_token=function(i){this.output.push(i)};this.indent=function(){this.indent_level++};this.unindent=function(){if(this.indent_level>0){this.indent_level--}}};return this}b=new f();b.printer(d,c,h);while(true){var e=b.get_token();b.token_text=e[0];b.token_type=e[1];b.tag_check=e[2];if(b.token_type==="TK_EOF"){break}switch(b.token_type){case"TK_TAG_START":case"TK_TAG_SCRIPT":case"TK_TAG_STYLE":b.prev_start_tag=b.tag_check;b.print_newline(false,b.output);b.print_token(b.token_text);b.indent();b.current_mode="CONTENT";break;case"TK_TAG_END":var g=b.tag_check.substr(1);if((g!="textarea")){b.print_newline(true,b.output)}b.print_token(b.token_text);b.current_mode="CONTENT";break;case"TK_TAG_SINGLE":b.print_newline(false,b.output);b.print_token(b.token_text);b.current_mode="CONTENT";break;case"TK_CONTENT":if(b.token_text!==""){b.print_newline(false,b.output);b.print_token(b.token_text)}b.current_mode="TAG";break}b.last_token=b.token_type;b.last_text=b.token_text}return b.output.join("")};